# 更新履歴 (Changelog)

cfFormMailerの全バージョンの変更履歴を記録します。

形式は [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/) に基づいており、
このプロジェクトは [セマンティックバージョニング](https://semver.org/lang/ja/) に準拠しています。

---

## [1.7.0] - 2025-11-18

### Changed
- バージョン番号を1.6.1から1.7.0に更新
- **ディレクトリ構成の大幅変更**
  - `assets/snippets/cfFormMailer/` → `src/`（ソースコード）
  - `assets/snippets/cfFormMailer/forms/` → `forms/`（フォーム定義）

### Fixed
- セッションからのファイルアップロード処理の改善
- 各種バグ修正とコードクリーンアップ

---

## [1.6.0] - 2020-03-03

### Changed
- **ディレクトリ構成の変更**（サンプルファイルを`forms/sample/`へ移動）
- **設定ファイル形式を.ini形式に変更**（旧形式からの移行推奨）

### Added
- `@FILE:パス`形式でのテンプレート指定をサポート
- スパム判定機能の追加（`isSpam()`メソッド）

### Fixed
- **PHP 7.x対応**
- 非公開リソースに設定を書いた場合の動作修正
- 複数行で記述されたフォームタグの解析改善
- 異体字（草彅・山﨑など）の文字化け対策
- `get_magic_quotes_gpc()`の削除（PHP 7.4対応）
- コードのリファクタリング

---

## [1.4.0] - 2015-03-02

### Changed
- **MODxMailerを直接使用するように変更**（`phpmailer_ex.php`削除）

### Fixed
- 各種バグ修正

---

## [1.3.0] - 2013-05-23

### Added
- **管理者メールのCC, BCC送信**（`admin_mail_cc`, `admin_mail_bcc`）
- **メール送信文字コードの指定**（`mail_charset`）
- **送信後遷移する完了画面を指定可能に**（`complete_redirect`）
- **選択肢による管理者メール送信先の動的変更**（`dynamic_send_to_field`）

### Changed
- 設定チャンクサンプル`config_chunk.txt`での以下初期値変更:
  - `reply_to`
  - `use_store_db`
  - `vericode`

---

## [1.2.0] - 2011-04-04

### Added
- **cfFormDBとの連携機能追加**（データベース保存）
- 検証メソッド`url`, `convert`追加
- 環境設定`use_store_db`, `send_mail`追加

### Changed
- `tel`検証メソッドを使用した項目は全角英字・ハイフンも半角に変換（従来は全角数字のみ）

### Fixed
- 長い件名への対応強化

---

## [1.1.2] - 2010-11-10

### Fixed
- **メール送信者名やメール件名が長い場合に不要な文字が挿入されてしまう不具合に対処**
  - ※Windows版PHPから`mail()`関数でメール送信する設定の場合は正常動作しない可能性あり
- ユーザーからのファイルアップロードの際、サーバー環境によって保存がうまくいかない場合に対処
  - 環境設定`upload_tmp_path`追加

---

## [1.1.0] - 2010-05-12

### Fixed
- 開始タグと閉じタグの間にテキストの無い偶数個目のタグ（`<textarea>`タグなど）について値の復元が正しく行われない不具合を修正
  - Thanks to trickstarさん

### Changed
- 同梱のサンプルテンプレートの名称を変更
  - Thanks to yamaさん（公式フォーラムより）
- cfFileViewプラグインをMODX v1.0.3でのプラグインインストール半自動化に対応

---

## [1.0.0] - 2010-03-06

### Added
- **ファイルを添付しての送信に対応**（環境設定`attach_file`, `attach_file_name`追加）
- **ユーザーからの画像ファイルアップロードと送信に対応**
- **携帯端末宛自動返信メールのテンプレートをPC宛とは独立して設定可能に**
  - 環境設定`tmpl_mail_reply_mobile`追加
- **valid属性の3番目のパラメータを`[+errors+]`表示時の項目名として利用**

### Changed
- **独自検証メソッド、独自フィルターメソッドの追加方法を変更**
  - ※従来の方法もひとまず使用可能ですが、非推奨
- 環境設定`admin_name`の初期値を「サイト名」から未定義に変更
- `class.cfFormMailerMODx.inc.php`を廃し、メインクラス内に統合

### Fixed
- メールの件名と送信者名が文字化けする場合がある不具合に対処
- `<select>`タグ、`<textarea>`タグへ`INVALID_CLASS`を付加する際に余分なスラッシュを付加してしまう問題を修正
- サンプルテンプレートでのID重複を削除

---

## [0.0.7.2] - 2009-09-12

### Fixed
- 独自検証メソッド、フィルターメソッド追加に関する不具合を修正
- フォームの各属性の値が大文字で記述されていた場合に、エラー画面で入力値が反映しない不具合を修正
- 空の`value`属性があった場合にタグが崩れる不具合を修正
- 入力画面サンプルチャンクの`<form>`タグに`action`属性を追加

---

## [0.0.7.1] - 2007-11-13

### Fixed
- 前後にタブを含む`<option>`タグを正常に処理できない不具合を修正
- 初期選択値（`selected="selected"`）が指定されている場合は削除

---

## [0.0.7] - 2007-11-04

### Added
- **HTMLメール送信に対応**
- 検証メソッド`tel`追加
- 自動返信先となるメールアドレスを任意指定可能に
- `[+reply_to+]`プレースホルダ追加

### Changed
- 自動返信先として指定したフィールドは必ず、メールアドレス形式として正しいかを検証
  - →検証メソッド`email`は付けなくて良い

### Fixed
- **EUC-JP環境化でのメール文字化け解消**

---

## [0.0.6] - 2007-10-23 (未公開)

### Added
- `[+sender_ip+]`, `[+sender_host+]`, `[+sender_ua+]`プレースホルダ追加
- 管理者宛メールアドレス（`admin_mail`）に複数のメールアドレスを指定可能に
- 検証メソッド`sameas`追加
- エラーのあるフィールドに任意のクラスセレクタを付加
- 環境設定項目追加:
  - `admin_ishtml`
  - `reply_ishtml`
  - `reply_fromname`
  - `invalid_class`

### Changed
- **`mb_send_mail()`関数ではなくMODX付属のPHPMailerクラスを使用するように変更**
  - 送信メールの文字コードは`iso-2022-jp`

### Fixed
- 一部の設定項目省略値が反映されない不具合を修正

---

## [0.0.5] - 2007-10-16 (未公開)

### Added
- **CAPTCHA認証コードに対応**
- 検証メソッド`range`追加

### Fixed
- 入力値が空(NULL)の場合は確認画面表示時に`&nbsp;`に変換

---

## [0.0.4] - 2007-10-09

### Fixed
- `[+errors+]`が効かない不具合を修正
- システムが付加するフィールドはアンダースコア(`_`)から始まる名称に変更

### Added
- **`<label>`タグに対応**
- 入力必須項目のエラーメッセージで、ラジオボタンやリストのときは「選択必須項目です」と表示
  - 他は「入力必須項目です」

---

## レガシーバージョン

### [0.0.3] - 2007-XX-XX
初期バージョン（詳細記録なし）

---

## リンク

- [リファクタリング提案書](REFACTORING_PROPOSAL.md)
- [移行ガイド](MIGRATION_GUIDE.md)
- [インストールガイド](INSTALLATION.md)

---

**最終更新**: 2025-11-18
